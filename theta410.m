function y = theta410(x)
%THETA410 Filters input x and returns output y.

% MATLAB Code
% Generated by MATLAB(R) 9.5 and 0.1.3 DSP System Toolbox.Generated by MATLAB(R) 9.7 and
% Generated on: 14-Sep-2021 13:13:04

%#codegen

% To generate C/C++ code from this function use the codegen command. Type
% 'help codegen' for more information.

persistent Hd;

if isempty(Hd)
    
    % The following code was used to design the filter coefficients:
    % % FIR Window Bandpass filter designed using the FIR1 function.
    %
    % % All frequency values are in Hz.
    % Fs = 32000;  % Sampling Frequency
    %
    % N    = 300;      % Order
    % Fc1  = 4;        % First Cutoff Frequency
    % Fc2  = 10;       % Second Cutoff Frequency
    % flag = 'scale';  % Sampling Flag
    % % Create the window vector for the design algorithm.
    % win = blackman(N+1);
    %
    % % Calculate the coefficients using the FIR1 function.
    % b  = fir1(N, [Fc1 Fc2]/(Fs/2), 'bandpass', win, flag);
    
    Hd = dsp.FIRFilter( ...
        'Numerator', [0 3.07794507152291e-07 1.23213439388478e-06 ...
        2.77532554698982e-06 4.94083295938152e-06 7.73327482062157e-06 ...
        1.11584135424296e-05 1.52231437334623e-05 1.99354771435234e-05 ...
        2.53045246032793e-05 3.13404749913492e-05 3.80545712664506e-05 ...
        4.54590836079658e-05 5.35672797139539e-05 6.23933923111755e-05 ...
        7.19525839371486e-05 8.22609090596219e-05 9.3335273604068e-05 ...
        0.000105193391964924 0.000117853741581268 0.000131335515162462 ...
        0.000145658570653976 0.000160843379038095 0.000176910970068606 ...
        0.000193882876042672 0.000211781073717151 0.000230627924480341 ...
        0.000250446112893775 0.000271258583722048 0.000293088477571829 ...
        0.000315959065264168 0.000339893681066941 0.000364915654916745 ...
        0.000391048243761862 0.000418314562159881 0.000446737512265387 ...
        0.00047633971334465 0.000507143430955511 0.000539170505931715 ...
        0.000572442283311721 0.000606979541352517 0.000642802420769251 ...
        0.00067993035434151 0.000718381997026772 0.000758175156721128 ...
        0.000799326725806524 0.00084185261362281 0.000885767680001578 ...
        0.000931085669997233 0.000977819149948992 0.00102597944500546 ...
        0.00107557657824112 0.0011266192114917 0.00117911458803244 ...
        0.00123306847722042 0.00128848512121898 0.00134536718391862 ...
        0.00140371570216541 0.00146353003940372 0.00152480784183656 ...
        0.00158754499720202 0.00165173559626023 0.00171737189708058 ...
        0.00178444429221407 0.00185294127883084 0.0019228494318977 ...
        0.00199415338046543 0.00206683578713 0.00214087733072664 ...
        0.00221625669230974 0.00229295054446621 0.00237093354400379 ...
        0.00245017832805004 0.0025306555135918 0.00261233370047871 ...
        0.00269517947790846 0.00277915743440516 0.00286423017129603 ...
        0.00295035831968562 0.00303750056092028 0.00312561365052957 ...
        0.00321465244562508 0.00330456993573086 0.00339531727701379 ...
        0.00348684382987563 0.00357909719986306 0.00367202328184555 ...
        0.00376556630740532 0.00385966889537768 0.00395427210547431 ...
        0.00404931549491676 0.00414473717800137 0.0042404738885122 ...
        0.00433646104489265 0.00443263281808191 0.00452892220191716 ...
        0.00462526108599788 0.00472158033090394 0.0048178098456548 ...
        0.00491387866729304 0.00500971504247127 0.00510524651091788 ...
        0.00520039999065333 0.00529510186482547 0.00538927807002914 ...
        0.00548285418597249 0.0055757555263497 0.00566790723077741 ...
        0.00575923435765008 0.00584966197776726 0.00593911526858457 ...
        0.00602751960893824 0.00611480067409231 0.00620088453095645 ...
        0.00628569773332188 0.0063691674169623 0.0064512213944469 ...
        0.00653178824951248 0.00661079743084213 0.00668817934509882 ...
        0.00676386544906287 0.00683778834072389 0.00690988184917888 ...
        0.00698008112319012 0.00704832271825851 0.00711454468207006 ...
        0.00717868663817593 0.00724068986776909 0.00730049738942349 ...
        0.00735805403666518 0.00741330653324779 0.00746620356600896 ...
        0.00751669585518773 0.00756473622208725 0.00761027965397141 ...
        0.00765328336608832 0.00769370686071855 0.00773151198315054 ...
        0.00776666297449086 0.00779912652122204 0.00782887180142605 ...
        0.00785587052759719 0.00788009698597325 0.00790152807232022 ...
        0.00792014332411104 0.0079359249490453 0.00794885784986256 ...
        0.00795892964540825 0.00796613068791715 0.00797045407648599 ...
        0.00797189566671262 0.00797045407648599 0.00796613068791715 ...
        0.00795892964540825 0.00794885784986256 0.0079359249490453 ...
        0.00792014332411104 0.00790152807232022 0.00788009698597325 ...
        0.00785587052759719 0.00782887180142605 0.00779912652122204 ...
        0.00776666297449086 0.00773151198315054 0.00769370686071855 ...
        0.00765328336608832 0.00761027965397141 0.00756473622208725 ...
        0.00751669585518773 0.00746620356600896 0.00741330653324779 ...
        0.00735805403666518 0.00730049738942349 0.00724068986776909 ...
        0.00717868663817593 0.00711454468207006 0.00704832271825851 ...
        0.00698008112319012 0.00690988184917888 0.00683778834072389 ...
        0.00676386544906287 0.00668817934509882 0.00661079743084213 ...
        0.00653178824951248 0.0064512213944469 0.0063691674169623 ...
        0.00628569773332188 0.00620088453095645 0.00611480067409231 ...
        0.00602751960893824 0.00593911526858457 0.00584966197776726 ...
        0.00575923435765008 0.00566790723077741 0.0055757555263497 ...
        0.00548285418597249 0.00538927807002914 0.00529510186482547 ...
        0.00520039999065333 0.00510524651091788 0.00500971504247127 ...
        0.00491387866729304 0.0048178098456548 0.00472158033090394 ...
        0.00462526108599788 0.00452892220191716 0.00443263281808191 ...
        0.00433646104489265 0.0042404738885122 0.00414473717800137 ...
        0.00404931549491676 0.00395427210547431 0.00385966889537768 ...
        0.00376556630740532 0.00367202328184555 0.00357909719986306 ...
        0.00348684382987563 0.00339531727701379 0.00330456993573086 ...
        0.00321465244562508 0.00312561365052957 0.00303750056092028 ...
        0.00295035831968562 0.00286423017129603 0.00277915743440516 ...
        0.00269517947790846 0.00261233370047871 0.0025306555135918 ...
        0.00245017832805004 0.00237093354400379 0.00229295054446621 ...
        0.00221625669230974 0.00214087733072664 0.00206683578713 ...
        0.00199415338046543 0.0019228494318977 0.00185294127883084 ...
        0.00178444429221407 0.00171737189708058 0.00165173559626023 ...
        0.00158754499720202 0.00152480784183656 0.00146353003940372 ...
        0.00140371570216541 0.00134536718391862 0.00128848512121898 ...
        0.00123306847722042 0.00117911458803244 0.0011266192114917 ...
        0.00107557657824112 0.00102597944500546 0.000977819149948992 ...
        0.000931085669997233 0.000885767680001578 0.00084185261362281 ...
        0.000799326725806524 0.000758175156721128 0.000718381997026772 ...
        0.00067993035434151 0.000642802420769251 0.000606979541352517 ...
        0.000572442283311721 0.000539170505931715 0.000507143430955511 ...
        0.00047633971334465 0.000446737512265387 0.000418314562159881 ...
        0.000391048243761862 0.000364915654916745 0.000339893681066941 ...
        0.000315959065264168 0.000293088477571829 0.000271258583722048 ...
        0.000250446112893775 0.000230627924480341 0.000211781073717151 ...
        0.000193882876042672 0.000176910970068606 0.000160843379038095 ...
        0.000145658570653976 0.000131335515162462 0.000117853741581268 ...
        0.000105193391964924 9.3335273604068e-05 8.22609090596219e-05 ...
        7.19525839371486e-05 6.23933923111755e-05 5.35672797139539e-05 ...
        4.54590836079658e-05 3.80545712664506e-05 3.13404749913492e-05 ...
        2.53045246032793e-05 1.99354771435234e-05 1.52231437334623e-05 ...
        1.11584135424296e-05 7.73327482062157e-06 4.94083295938152e-06 ...
        2.77532554698982e-06 1.23213439388478e-06 3.07794507152291e-07 0]);
end

y = step(Hd,double(x));

delay = mean(grpdelay(Hd));

y(1:delay) = [];

% [EOF]
